# Тестирование токенов в Postman

## Проблема
Токен передается в заголовках, но не приходит на сервер.

## Решение

### 1. Проверьте правильный порт
Сервер запускается на порту **3000**, а не 3002.

### 2. Получение токена
1. Создайте POST запрос на `http://localhost:3000/api/auth/login`
2. В Headers добавьте: `Content-Type: application/json`
3. В Body (raw JSON) отправьте:
```json
{
    "email": "admin@example.com",
    "password": "admin123"
}
```

### 3. Использование токена
1. Создайте новый запрос к защищенному эндпоинту
2. В разделе **Headers** добавьте:
   - **Key**: `Authorization`
   - **Value**: `Bearer <ваш-токен>`

### 4. Примеры тестирования

#### Тест 1: Создание категории (требует ADMIN)
```
POST http://localhost:3000/api/categories
Headers:
  Authorization: Bearer <ваш-токен>
  Content-Type: application/json
Body:
{
    "name": "Тестовая категория",
    "description": "Описание категории"
}
```

#### Тест 2: Просмотр пользователей (требует ADMIN)
```
GET http://localhost:3000/api/user
Headers:
  Authorization: Bearer <ваш-токен>
```

#### Тест 3: Публичный эндпоинт (не требует токен)
```
GET http://localhost:3000/api/categories
```

### 5. Отладка в Postman

#### Проверьте заголовки:
1. Откройте вкладку "Headers" в Postman
2. Убедитесь, что заголовок `Authorization` добавлен
3. Значение должно быть в формате: `Bearer <токен>`

#### Проверьте токен:
1. Скопируйте токен из ответа login
2. Убедитесь, что он не содержит лишних символов
3. Проверьте, что токен не истек

#### Проверьте URL:
1. Используйте правильный порт: `3000`
2. Убедитесь, что путь начинается с `/api/`

### 6. Возможные проблемы

#### Проблема 1: Неправильный порт
- **Симптом**: "Невозможно соединиться с удаленным сервером"
- **Решение**: Используйте порт 3000 вместо 3002

#### Проблема 2: Неправильный формат токена
- **Симптом**: 401 Unauthorized
- **Решение**: Убедитесь, что токен начинается с "Bearer "

#### Проблема 3: Истекший токен
- **Симптом**: 401 Unauthorized
- **Решение**: Получите новый токен через /api/auth/login

#### Проблема 4: Недостаточно прав
- **Симптом**: 403 Forbidden
- **Решение**: Используйте токен администратора

### 7. Логирование на сервере

Сервер теперь логирует:
- Все заголовки запроса
- Заголовок Authorization
- URL и метод запроса
- Процесс извлечения JWT токена

Проверьте логи сервера для отладки.

### 8. Тестовые данные

#### Администратор:
- Email: `admin@example.com`
- Password: `admin123`

#### Обычный пользователь:
- Email: `testuser@example.com`
- Password: `testuser123` 
# Функциональность хедера с авторизацией

## Описание

Реализована логика изменения хедера в зависимости от статуса авторизации пользователя:

### Если пользователь НЕ залогинился:
- В хедере отображается пункт меню "Login"
- При переходе на страницу Login название меняется на "To Main" (как у других пунктов хедера)
- При нажатии на "To Main" происходит переход на главную страницу

### Если пользователь залогинился:
- Пункт меню "Login" исчезает из хедера
- Справа добавляется пункт "Мой кабинет" для перехода в личный кабинет
- При переходе на страницу "Мой кабинет" название меняется на "To Main" (как у других пунктов хедера)
- При нажатии на "To Main" происходит переход на главную страницу

## Измененные файлы

### 1. `src/components/MainConstruct/Head/Up/up.tsx`
Основная логика изменения хедера:
- Добавлена проверка статуса авторизации
- Условное отображение пункта "Login"
- Добавление "Мой кабинет" для авторизованных пользователей
- Правильное позиционирование элементов навигации

### 2. `src/components/MainConstruct/Head/Header.tsx`
Обновлен для передачи текущего роута в UpHead:
- Добавлен `currentRoute` в setup
- Передача `routeName` в компонент UpHead

## Логика работы

### Проверка авторизации
```typescript
const isUserAuthenticated = computed(() => isAuthenticated())
```

### Условное отображение Login
```typescript
// Если это роут Login и пользователь авторизован, пропускаем его
if (label === 'Login' && this.isUserAuthenticated) {
    return null
}

// Если это роут Login и пользователь НЕ авторизован, показываем "Login"
if (label === 'Login' && !this.isUserAuthenticated) {
    return <NGridItem span={2}>
        <RouterLink to={`${toName==this.currentRoute.path?'/':toName}`}>
            <div className={'header-element'}>
                {label==this.currentRoute.name?'To Main':label}
            </div>
        </RouterLink>
    </NGridItem>
}
```

### Добавление "Мой кабинет"
```typescript
// Если пользователь авторизован, добавляем "Мой кабинет" справа
if (this.isUserAuthenticated) {
    // Добавляем пустой элемент для выравнивания
    nGiArr.push(
        <NGridItem span={1} style={'align-items: center;'}></NGridItem>
    )
    nGiArr.push(
        <NGridItem span={2} style={'align-items: center; overflow: hidden;'}>
            <RouterLink to={'/cabinet'}>
                <div className={'header-element'}>
                    {this.currentRoute.name === 'UserCabinet' ? 'To Main' : 'Мой кабинет'}
                </div>
            </RouterLink>
        </NGridItem>
    )
}
```

### Логика изменения названий
```typescript
// Для Login (неавторизованные пользователи)
{label==this.currentRoute.name?'To Main':label}

// Для "Мой кабинет" (авторизованные пользователи)
{this.currentRoute.name === 'UserCabinet' ? 'To Main' : 'Мой кабинет'}
```

### Логика переходов
```typescript
// Для всех пунктов меню - при "To Main" переход на главную
<RouterLink to={label==this.currentRoute.name?'/':toName}>

// Для "Мой кабинет" - при "To Main" переход на главную
<RouterLink to={this.currentRoute.name === 'UserCabinet' ? '/' : '/cabinet'}>
```

## Тестирование

Создан тестовый файл `test-header-auth.html` для проверки функциональности:

### Возможности тестирования:
1. **Вход в систему** - имитирует авторизацию пользователя
2. **Выход из системы** - очищает данные авторизации
3. **Проверка статуса** - показывает текущий статус авторизации
4. **Очистка localStorage** - полностью очищает все данные

### Что тестируется:
- Отображение хедера для неавторизованных пользователей
- Отображение хедера для авторизованных пользователей
- Изменение навигации при смене статуса авторизации
- Правильное позиционирование "Мой кабинет"
- Изменение названия "Login" на "To Main" при переходе на страницу Login
- Изменение названия "Мой кабинет" на "To Main" при переходе на страницу кабинета

## Зависимости

- Vue 3 с Composition API
- Vue Router 4
- Naive UI для компонентов
- TypeScript для типизации

## Запуск

1. Установите зависимости: `npm install`
2. Запустите dev сервер: `npm run dev`
3. Откройте тестовый файл `test-header-auth.html` в браузере для проверки функциональности

## Примечания

- Статус авторизации проверяется через функцию `isAuthenticated()` из `src/utils/api.ts`
- Изменения в хедере происходят реактивно при изменении статуса авторизации
- Добавлен `watch` для отслеживания изменений статуса авторизации
- Все изменения типизированы с использованием TypeScript

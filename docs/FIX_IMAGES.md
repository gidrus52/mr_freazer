# Исправление проблемы с изображениями после деплоя

## Проблема

После деплоя на сервер изображения не отображаются, потому что в коде использовались строковые пути вида `"src/assets/img/..."`, которые не работают в production сборке Vite.

## Решение

### 1. Создана утилита для правильных путей

Создан файл `frontend/src/utils/imageUtils.ts` с функцией `getImageUrl()`, которая правильно формирует пути к изображениям в зависимости от окружения (dev/production).

### 2. Обновлены компоненты

Обновлены следующие файлы:
- `frontend/src/view/AppView/AppView.tsx` - исправлены пути к изображениям
- `frontend/src/view/ProductionView/ProductionView.tsx` - исправлены пути к изображениям
- `frontend/src/components/main.tsx` - исправлен путь к иконке

### 3. Настроен Vite

Обновлен `frontend/vite.config.ts` для правильной обработки статических файлов при сборке.

## Что нужно сделать

### Вариант 1: Пересобрать и задеплоить (рекомендуется)

```bash
# На сервере
cd /opt/mr_freazer

# Получить последние изменения
git pull origin main

# Пересобрать frontend с исправлениями
docker-compose build --no-cache nginx

# Перезапустить
docker-compose up -d
```

### Вариант 2: Если изображения все еще не работают

Если после пересборки изображения все еще не работают, возможно нужно скопировать изображения в `public` директорию:

```bash
# На сервере в директории проекта
cd /opt/mr_freazer/frontend

# Создать директорию public/img если её нет
mkdir -p public/img

# Скопировать изображения из src/assets/img в public/img
cp -r src/assets/img/* public/img/

# Пересобрать
cd /opt/mr_freazer
docker-compose build --no-cache nginx
docker-compose up -d
```

### Вариант 3: Проверка путей в браузере

1. Откройте сайт в браузере
2. Откройте DevTools (F12)
3. Перейдите на вкладку Network
4. Попробуйте загрузить страницу с изображениями
5. Проверьте, какие запросы к изображениям возвращают 404

Если видите запросы к `/assets/img/...`, но они возвращают 404, значит файлы не скопировались при сборке.

## Проверка после исправления

1. Откройте сайт: `http://82.148.6.221`
2. Проверьте, что изображения отображаются на главной странице
3. Проверьте страницу "Применение" (AppView) - должны отображаться изображения для подкатегорий
4. Проверьте страницу "Производство" (ProductionView) - должны отображаться изображения для блоков

## Технические детали

### Как работает getImageUrl()

- **В dev режиме**: возвращает `/src/assets/img/...` (полный путь для Vite dev server)
- **В production**: возвращает `/assets/img/...` (путь относительно корня сайта)

### Как Vite обрабатывает статические файлы

- Файлы из `src/assets/` обрабатываются через импорты и получают хеши в именах
- Файлы из `public/` копируются как есть в корень `dist/`
- Строковые пути не обрабатываются автоматически

### Решение

Используем функцию `getImageUrl()`, которая формирует правильные пути. В production эти пути должны указывать на файлы, которые либо:
1. Импортированы напрямую (получают хеши)
2. Находятся в `public/` (копируются как есть)

## Если проблема сохраняется

1. Проверьте логи nginx: `docker-compose logs nginx`
2. Проверьте структуру dist: `docker-compose exec nginx ls -la /usr/share/nginx/html/assets/`
3. Проверьте права доступа к файлам
4. Убедитесь, что nginx правильно настроен для раздачи статических файлов (см. `nginx.conf`)


# Настройка HTTPS с AlphaSSL сертификатом

## Быстрая настройка

### 1. Разместите файлы сертификата

Поместите файлы AlphaSSL сертификата в директорию `ssl/`:

```bash
ssl/
├── certificate.crt    # Основной сертификат (или .pem)
└── private.key        # Приватный ключ
```

**Важно:** 
- Если у вас файлы с другими именами, переименуйте их в `certificate.crt` и `private.key`
- Если у вас есть файл с промежуточными сертификатами (intermediate certificate chain), переименуйте его в `ca-bundle.crt` и раскомментируйте строку `ssl_trusted_certificate` в `nginx.conf`

### 2. Настройте доменное имя (опционально)

Если у вас есть доменное имя, замените `localhost` на ваше доменное имя в файле `nginx.conf`:

```nginx
server_name yourdomain.com www.yourdomain.com;
```

### 3. Настройте порты (опционально)

В файле `.env` или `docker-compose.yml` можно изменить порты:

```env
FRONTEND_PORT=80
HTTPS_PORT=443
```

### 4. Перезапустите контейнеры

```bash
# Остановите текущие контейнеры
docker-compose down

# Пересоберите nginx контейнер (если нужно)
docker-compose build nginx

# Запустите контейнеры
docker-compose up -d

# Проверьте логи
docker-compose logs nginx
```

### 5. Проверьте работу

После запуска приложение будет доступно:
- **HTTPS:** https://ваш_домен (порт 443)
- **HTTP:** автоматически перенаправляется на HTTPS (порт 80)

## Проверка сертификата

### Проверка через браузер
Откройте https://ваш_домен и проверьте, что:
- Сертификат отображается как валидный
- Нет предупреждений о безопасности
- Соединение использует HTTPS

### Проверка через командную строку

```bash
# Проверка сертификата
openssl s_client -connect localhost:443 -servername yourdomain.com

# Проверка через curl
curl -vI https://yourdomain.com
```

## Устранение проблем

### Nginx не запускается

**Проблема:** Контейнер nginx падает с ошибкой о сертификатах

**Решение:** 
1. Убедитесь, что файлы `certificate.crt` и `private.key` находятся в директории `ssl/`
2. Проверьте права доступа к файлам:
   ```bash
   chmod 600 ssl/private.key
   chmod 644 ssl/certificate.crt
   ```
3. Проверьте логи: `docker-compose logs nginx`

### Ошибка "SSL certificate not found"

**Решение:** 
- Убедитесь, что файлы имеют правильные имена: `certificate.crt` и `private.key`
- Проверьте, что директория `ssl/` монтируется в контейнер (проверьте `docker-compose.yml`)

### Сертификат не доверяется браузером

**Решение:**
- Убедитесь, что вы используете правильный домен (сертификат выдан для конкретного домена)
- Если есть промежуточные сертификаты, добавьте их в `ca-bundle.crt` и раскомментируйте `ssl_trusted_certificate` в `nginx.conf`

## Дополнительная информация

Подробная информация о размещении сертификатов находится в файле `ssl/README.md`

